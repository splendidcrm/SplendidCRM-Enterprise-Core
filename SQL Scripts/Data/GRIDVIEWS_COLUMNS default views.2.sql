

set nocount on;
GO

-- 04/27/2006 Paul.  Add URL_MODULE to support ACL.
-- 05/02/2006 Paul.  Add URL_ASSIGNED_FIELD to support ACL. 
if exists(select distinct GRIDVIEWS_COLUMNS.GRID_NAME
            from           GRIDVIEWS_COLUMNS
           left outer join GRIDVIEWS_COLUMNS GRIDVIEWS_COLUMNS_DEFAULTS
                        on GRIDVIEWS_COLUMNS_DEFAULTS.GRID_NAME    = GRIDVIEWS_COLUMNS.GRID_NAME
                       and GRIDVIEWS_COLUMNS_DEFAULTS.DEFAULT_VIEW = 1
                       and GRIDVIEWS_COLUMNS_DEFAULTS.DELETED      = 0
           where GRIDVIEWS_COLUMNS_DEFAULTS.ID is null
             and GRIDVIEWS_COLUMNS.DELETED = 0) begin -- then

	-- 09/19/2012 Paul.  Add new fields.  Should have done this long ago. 
	insert into GRIDVIEWS_COLUMNS(ID, DEFAULT_VIEW, CREATED_BY, DATE_ENTERED, MODIFIED_USER_ID, DATE_MODIFIED, DATE_MODIFIED_UTC, GRID_NAME, COLUMN_INDEX, COLUMN_TYPE, HEADER_TEXT, SORT_EXPRESSION, ITEMSTYLE_WIDTH, ITEMSTYLE_CSSCLASS, ITEMSTYLE_HORIZONTAL_ALIGN, ITEMSTYLE_VERTICAL_ALIGN, ITEMSTYLE_WRAP, DATA_FIELD, DATA_FORMAT, URL_FIELD, URL_FORMAT, URL_TARGET, LIST_NAME, URL_MODULE, URL_ASSIGNED_FIELD, MODULE_TYPE, PARENT_FIELD)
	select                   newid(), 1           , CREATED_BY, DATE_ENTERED, MODIFIED_USER_ID, DATE_MODIFIED, DATE_MODIFIED_UTC, GRID_NAME, COLUMN_INDEX, COLUMN_TYPE, HEADER_TEXT, SORT_EXPRESSION, ITEMSTYLE_WIDTH, ITEMSTYLE_CSSCLASS, ITEMSTYLE_HORIZONTAL_ALIGN, ITEMSTYLE_VERTICAL_ALIGN, ITEMSTYLE_WRAP, DATA_FIELD, DATA_FORMAT, URL_FIELD, URL_FORMAT, URL_TARGET, LIST_NAME, URL_MODULE, URL_ASSIGNED_FIELD, MODULE_TYPE, PARENT_FIELD
	  from GRIDVIEWS_COLUMNS
	 where DELETED = 0
	   and GRID_NAME in (select distinct GRIDVIEWS_COLUMNS.GRID_NAME
	                       from           GRIDVIEWS_COLUMNS
	                      left outer join GRIDVIEWS_COLUMNS GRIDVIEWS_COLUMNS_DEFAULTS
	                                   on GRIDVIEWS_COLUMNS_DEFAULTS.GRID_NAME    = GRIDVIEWS_COLUMNS.GRID_NAME
	                                  and GRIDVIEWS_COLUMNS_DEFAULTS.DEFAULT_VIEW = 1
	                                  and GRIDVIEWS_COLUMNS_DEFAULTS.DELETED      = 0
	                      where GRIDVIEWS_COLUMNS_DEFAULTS.ID is null
	                        and GRIDVIEWS_COLUMNS.DELETED = 0);
end -- if;
GO

set nocount off;
GO

/* -- #if Oracle
	EXCEPTION
		WHEN NO_DATA_FOUND THEN
			StoO_selcnt := 0;
		WHEN OTHERS THEN
			RAISE;
	END;
	COMMIT WORK;
END;
/
-- #endif Oracle */

/* -- #if IBM_DB2
	commit;
  end
/

call dbo.spGRIDVIEWS_COLUMNS_DefaultViews()
/

call dbo.spSqlDropProcedure('spGRIDVIEWS_COLUMNS_DefaultViews')
/

-- #endif IBM_DB2 */

